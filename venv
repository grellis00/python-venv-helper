#!/bin/bash

# Define the name of the virtual environment directory
VENV_DIR="venv"

# Check if the directory exists and is a virtual environment
if [ -d "$VENV_DIR" ] && [ -f "$VENV_DIR/bin/activate" ]; then
    echo "Virtual environment already exists. Activating..."
    source "$VENV_DIR/bin/activate"
else
    echo "Virtual environment not found. Creating a new one..."
    python3 -m venv "$VENV_DIR"
    if [ $? -eq 0 ]; then
        echo "Virtual environment created successfully. Activating..."
        source "$VENV_DIR/bin/activate"
    else
        echo "Failed to create the virtual environment."
        exit 1
    fi
fi

# Upgrade pip to ensure compatibility with the virtual environment
echo "Upgrading pip to the latest version..."
python3 -m pip install --upgrade pip

# Verify activation
if [[ "$(which python)" != "$(pwd)/$VENV_DIR/bin/python" ]]; then
    echo "Error: Virtual environment is not activated correctly."
    exit 1
fi

echo "Using Python interpreter: $(which python)"
